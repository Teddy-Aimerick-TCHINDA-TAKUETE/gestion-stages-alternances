import{a as B}from"./chunk-BYWXCTMR.js";import{a as z}from"./chunk-K3IUYF2E.js";import{$ as O,A as x,B as d,D as s,E,F as b,Q as y,R as I,T as F,Z as T,da as A,ea as N,fa as c,ga as M,ha as q,ja as P,ka as k,la as L,ma as R,n as a,na as j,oa as D,p as m,q as C,qa as G,s as p,sa as w,t as l,ta as V,u as n,v as o,w as _}from"./chunk-XPQBKRV7.js";function H(e,i){e&1&&(n(0,"span"),s(1,"\u274C Le tire est requis."),o())}function J(e,i){if(e&1&&(n(0,"div",12),p(1,H,2,0,"span",8),o()),e&2){let t,r=d();a(),l("ngIf",(t=r.stageForm.get("titre"))==null||t.errors==null?null:t.errors.required)}}function K(e,i){e&1&&(n(0,"span"),s(1,"\u274C La description est requis."),o())}function Q(e,i){if(e&1&&(n(0,"div",12),p(1,K,2,0,"span",8),o()),e&2){let t,r=d();a(),l("ngIf",(t=r.stageForm.get("description"))==null||t.errors==null?null:t.errors.required)}}function U(e,i){e&1&&(n(0,"span"),s(1,"\u274C Le lieu est requis."),o())}function W(e,i){if(e&1&&(n(0,"div",12),p(1,U,2,0,"span",8),o()),e&2){let t,r=d();a(),l("ngIf",(t=r.stageForm.get("lieu"))==null||t.errors==null?null:t.errors.required)}}function X(e,i){e&1&&(n(0,"span"),s(1,"\u274C La durr\xE9e est requis."),o())}function Y(e,i){if(e&1&&(n(0,"div",12),p(1,X,2,0,"span",8),o()),e&2){let t,r=d();a(),l("ngIf",(t=r.stageForm.get("duree"))==null||t.errors==null?null:t.errors.required)}}function Z(e,i){if(e&1&&(n(0,"option",13),s(1),o()),e&2){let t=i.$implicit;l("value",t),a(),E(t)}}function ee(e,i){e&1&&(n(0,"span"),s(1,"\u274C Le type est requis."),o())}function te(e,i){if(e&1&&(n(0,"div",12),p(1,ee,2,0,"span",8),o()),e&2){let t,r=d();a(),l("ngIf",(t=r.stageForm.get("type"))==null||t.errors==null?null:t.errors.required)}}function ie(e,i){e&1&&(n(0,"label"),s(1,"Entreprise :"),o())}function re(e,i){if(e&1&&(n(0,"option",13),s(1),o()),e&2){let t=i.$implicit;l("value",t.id),a(),b(" ",t.nom," ")}}function ne(e,i){if(e&1&&(n(0,"select",14),p(1,re,2,2,"option",7),o()),e&2){let t=d();a(),l("ngForOf",t.entreprises)}}function oe(e,i){e&1&&(n(0,"span"),s(1,"\u274C L'entreprise est requise."),o())}function ae(e,i){if(e&1&&(n(0,"div",12),p(1,oe,2,0,"span",8),o()),e&2){let t,r=d();a(),l("ngIf",(t=r.stageForm.get("entrepriseId"))==null||t.errors==null?null:t.errors.required)}}var $=class e{constructor(i,t,r,u,g,f,v){this.authService=i;this.fb=t;this.stageService=r;this.entrepriseService=u;this.route=g;this.router=f;this.alertService=v;this.stageForm=this.fb.group({titre:["",c.required],description:["",c.required],lieu:["",c.required],duree:["",c.required],entrepriseId:["",c.required],type:["",c.required]})}stageForm;stageId;entreprises=[];typeStageOptions=["STAGE","ALTERNANCE"];message="";messageType="";ngOnInit(){this.stageId=Number(this.route.snapshot.paramMap.get("id")),this.stageId&&this.stageService.getStageById(this.stageId).subscribe(i=>{this.stageForm.patchValue({titre:i?.titre,description:i?.description,lieu:i?.lieu,duree:i?.duree,entrepriseId:i?.entreprise.id,type:i?.type})}),this.entrepriseService.getAllEntreprises().subscribe({next:i=>this.entreprises=i,error:i=>console.error("Erreur lors du chargement des entreprises",i)})}onSubmit(){if(this.stageForm.valid&&this.stageId){let i={id:this.stageId,titre:this.stageForm.value.titre,description:this.stageForm.value.description,lieu:this.stageForm.value.lieu,duree:this.stageForm.value.duree,entreprise:{id:this.stageForm.value.entrepriseId},type:this.stageForm.value.type};this.stageService.updateStage(this.stageId,i).subscribe({next:()=>{this.messageType="success",this.message="\u2705 Stage/Alternance modifi\xE9(e) avec succ\xE8s !",this.alertService.success(this.message).then(()=>{this.router.navigate(["/stages",this.stageId])})},error:t=>{console.error("Erreur lors de la modification du stage/alternance",t),this.messageType="error",this.message="\u274C Erreur lors de la modification du stage/alternance.",this.alertService.error(this.message)}})}else this.messageType="error",this.message="\u26A0\uFE0F Merci de compl\xE9ter le formulaire correctement.",this.alertService.error(this.message)}annuler(){this.messageType="error",this.message="\u274C Ete vous sur de vouloir annuler les modifications ?",this.alertService.confirm(this.message).then(i=>{i.isConfirmed&&this.router.navigate(["/stages",this.stageId])})}static \u0275fac=function(t){return new(t||e)(m(A),m(G),m(B),m(z),m(T),m(O),m(V))};static \u0275cmp=C({type:e,selectors:[["app-stage-edit"]],decls:31,vars:11,consts:[[3,"ngSubmit","formGroup"],["type","text","formControlName","titre"],["class","error",4,"ngIf"],["formControlName","description"],["type","text","formControlName","lieu"],["type","text","formControlName","duree"],["formControlName","type"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","entrepriseId",4,"ngIf"],["type","submit",3,"disabled"],["type","button",3,"click"],[1,"error"],[3,"value"],["formControlName","entrepriseId"]],template:function(t,r){if(t&1&&(n(0,"h2"),s(1,"Modifier une Offre (Stage / Alternance)"),o(),n(2,"form",0),x("ngSubmit",function(){return r.onSubmit()}),n(3,"label"),s(4,"Titre :"),o(),_(5,"input",1),p(6,J,2,1,"div",2),n(7,"label"),s(8,"Description :"),o(),_(9,"textarea",3),p(10,Q,2,1,"div",2),n(11,"label"),s(12,"Lieu :"),o(),_(13,"input",4),p(14,W,2,1,"div",2),n(15,"label"),s(16,"Dur\xE9e :"),o(),_(17,"input",5),p(18,Y,2,1,"div",2),n(19,"label"),s(20,"Type :"),o(),n(21,"select",6),p(22,Z,2,2,"option",7),o(),p(23,te,2,1,"div",2)(24,ie,2,0,"label",8)(25,ne,2,1,"select",9)(26,ae,2,1,"div",2),n(27,"button",10),s(28,"Enregistrer"),o(),n(29,"button",11),x("click",function(){return r.annuler()}),s(30,"Annuler"),o()()),t&2){let u,g,f,v,S,h;a(2),l("formGroup",r.stageForm),a(4),l("ngIf",((u=r.stageForm.get("titre"))==null?null:u.invalid)&&((u=r.stageForm.get("titre"))==null?null:u.touched)),a(4),l("ngIf",((g=r.stageForm.get("description"))==null?null:g.invalid)&&((g=r.stageForm.get("description"))==null?null:g.touched)),a(4),l("ngIf",((f=r.stageForm.get("lieu"))==null?null:f.invalid)&&((f=r.stageForm.get("lieu"))==null?null:f.touched)),a(4),l("ngIf",((v=r.stageForm.get("duree"))==null?null:v.invalid)&&((v=r.stageForm.get("duree"))==null?null:v.touched)),a(4),l("ngForOf",r.typeStageOptions),a(),l("ngIf",((S=r.stageForm.get("type"))==null?null:S.invalid)&&((S=r.stageForm.get("type"))==null?null:S.touched)),a(),l("ngIf",r.authService.isAdmin()),a(),l("ngIf",r.authService.isAdmin()),a(),l("ngIf",r.authService.isAdmin()&&((h=r.stageForm.get("entrepriseId"))==null?null:h.invalid)&&((h=r.stageForm.get("entrepriseId"))==null?null:h.touched)),a(),l("disabled",r.stageForm.invalid)}},dependencies:[F,y,I,w,P,j,D,N,R,M,q,k,L],styles:["form[_ngcontent-%COMP%]{max-width:600px;margin:50px auto;padding:30px;background:#fff;border-radius:8px;box-shadow:0 0 10px #0000001a}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%;padding:10px 15px;margin:10px 0 20px;border:1px solid #ccc;border-radius:5px;font-size:1rem}label[_ngcontent-%COMP%]{font-weight:700;display:block;margin-bottom:5px}button[_ngcontent-%COMP%]{padding:10px 20px;margin-right:10px;background-color:#007bff;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:1rem;transition:background-color .3s}button[_ngcontent-%COMP%]:hover{background-color:#0056b3}button[type=button][_ngcontent-%COMP%]{background-color:#6c757d}button[type=button][_ngcontent-%COMP%]:hover{background-color:#565e64}h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px;color:#333}.error[_ngcontent-%COMP%]{color:red;margin-bottom:10px}"]})};export{$ as StageEditComponent};
